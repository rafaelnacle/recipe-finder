<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recipe Finder</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-zinc-900 text-white">
  <form id="search-form" class="max-w-md mx-auto mt-8">
    <label for="query" class="block text-lg mb-2">Search for recipes:</label>
    <input type="text" id="query" name="query" required
      class="w-full px-4 py-2 rounded border border-gray-300 shadow-sm focus:outline-none focus:border-pink-400 focus:ring focus:ring-pink-400 text-black">
    <button type="submit"
      class="mt-4 px-4 py-2 bg-pink-400 text-black rounded hover:bg-pink-400 focus:outline-none focus:pink-400">Search</button>
  </form>
  <div id="recipes-container" class="max-w-lg mx-auto mt-8">

  </div>
</body>

<script type="module">
  const searchForm = document.getElementById('search-form');
  const searchInput = document.getElementById('query'); // Updated variable name
  const recipeContainer = document.getElementById('recipes-container'); // Updated ID

  searchForm.addEventListener('submit', async (event) => {
    event.preventDefault();

    const query = searchInput.value.trim();
    if (query === '') return;

    try {
      const response = await fetch(`/search?query=${encodeURIComponent(query)}`);
      if (!response.ok) {
        throw new Error('Failed to fetch recipes');
      }

      const recipes = await response.json();
      renderRecipes(recipes);
    } catch (error) {
      console.error('Error fetching recipes:', error);
    }
  });

  function renderRecipes(recipes) {
    recipeContainer.innerHTML = ''; // Clear previous recipes

    recipes.forEach(recipe => {
      const recipeElement = document.createElement('div');
      recipeElement.classList.add('recipe', 'bg-indigo-100', 'text-black', 'p-4', 'mb-4', 'rounded', 'shadow-md');

      const titleElement = document.createElement('h2');
      titleElement.textContent = recipe.label;
      titleElement.classList.add('text-xl', 'font-bold', 'mb-2');
      recipeElement.appendChild(titleElement);

      const ingredientsList = document.createElement('ul');
      ingredientsList.classList.add('list-disc', 'list-inside', 'mb-4');
      recipe.ingredients.forEach(ingredient => {
        const ingredientItem = document.createElement('li');
        ingredientItem.textContent = ingredient.text;
        ingredientsList.appendChild(ingredientItem);
      });
      recipeElement.appendChild(ingredientsList);

      // Add more elements for other recipe information such as image, source, etc.

      recipeContainer.appendChild(recipeElement);
    });
  }

</script>

</html>